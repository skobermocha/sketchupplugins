  <head>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
  </head>
  <body>
    <div class="container">
      <form>
        <h1>Project Information</h1>
        <div class="form-row">
            <label for="basic-url">Ruleset</label>
            <div class="form-group col-md-12">
            <div class="form-check form-check-inline">
              <label class="form-check-label">
                <input class="form-check-input" type="radio" id="ruleset_13" name="ruleset" value="CA Res 2013"> 2013 Code
              </label>
            </div>
            <div class="form-check form-check-inline">
              <label class="form-check-label">
                <input class="form-check-input" type="radio" id="ruleset_16" name="ruleset" value="CA Res 2016" checked> 2016 Code
              </label>
            </div>
            <div class="form-check form-check-inline disabled">
              <label class="form-check-label">
                <input class="form-check-input" type="radio" id="ruleset_19" name="ruleset" value="CA Res 2019" disabled> 2019 Code
              </label>
            </div>
            </div>
        </div>
        <div class="form-row">
            <div class="form-group col-md-4">
              <label for="planname">Plan Name</label>
              <input type="text" class="form-control" id="planname" value="Plan Name">
            </div>
            <div class="form-group col-md-3">
              <label for="Address">Address</label>
              <input type="text" class="form-control" id="address" value="Project/Tract Name">
            </div>
            <div class="form-group col-md-3">
              <label for="citystate">City, State</label>
              <input type="text" class="form-control" id="citystate" value="City, State">
            </div>
            <div class="form-group col-md-2">
              <label for="zipcode">Zipcode</label>
              <input type="text" class="form-control" id="zipcode" value="95366">
            </div>
        </div>
        <div class="form-row">
            <div class="form-group col-md-4">
              <label for="climatezone">Climate Zone</label>
              <select class="form-control" id="climatezone">
                <option value="CZ1  (Arcata)">CZ1  (Arcata)</option>
                <option value="CZ2  (Santa Rosa)">CZ2  (Santa Rosa)</option>
                <option value="CZ3  (Oakland)">CZ3  (Oakland)</option>
                <option value="CZ4  (San Jose)">CZ4  (San Jose)</option>
                <option value="CZ5  (Santa Maria)">CZ5  (Santa Maria)</option>
                <option value="CZ6  (Torrance)">CZ6  (Torrance)</option>
                <option value="CZ7  (San Diego)">CZ7  (San Diego)</option>
                <option value="CZ8  (Fullerton)">CZ8  (Fullerton)</option>
                <option value="CZ9  (Burbank)">CZ9  (Burbank)</option>
                <option value="CZ10  (Riverside)">CZ10  (Riverside)</option>
                <option value="CZ11  (Red Bluff)">CZ11  (Red Bluff)</option>
                <option value="CZ12  (Sacramento)" selected>CZ12  (Sacramento)</option>
                <option value="CZ13  (Fresno)">CZ13  (Fresno)</option>
                <option value="CZ14  (Palmdale)">CZ14  (Palmdale)</option>
                <option value="CZ15  (Palm Springs)">CZ15  (Palm Springs)</option>
                <option value="CZ16  (Blue Canyon)">CZ16  (Blue Canyon)</option>
              </select>
            </div>
            <div class="form-group col-md-2">
              <label for="totalsf">Total SF</label>
              <input type="text" class="form-control" id="totalsf" value="1000">
            </div>
            <div class="form-group col-md-2">
              <label for="bedroomcount">Bedroom Count</label>
              <input type="text" class="form-control" id="bedroomcount" value="3">
            </div>
            <div class="form-group col-md-2">
              <label for="storycount">Story Count</label>
              <select class="form-control" id="storycount">
                <option value="1" selected>1 Story</option>
                <option value="2">2 Stories</option>
                <option value="3">3 Stories</option>
              </select>
            </div>
            <div class="form-group col-md-2">
              <label for="ceilingheight">Avg Ceiling Height</label>
              <input type="text" class="form-control" id="ceilingheight" value="9">
            </div>
        </div>

        <!-- 3 columns for scenarios options -->
        <h1>Scenarios</h1>
        <div class="form-row">
            <div class="form-group col-md-4">
              <div class="card">
                <div class="card-header">
                  <div class="form-check form-check-inline">
                    <label class="form-check-label">
                      <input class="form-check-input" type="checkbox" id="scenario1" checked> Scenario 1
                    </label>
                  </div>
                </div>
                <div class="card-body">
                  <div class="form-group">
                    <label for="scenario1_label">Scenario 1 Label</label>
                    <input type="text" class="form-control" id="scenario1_label" value="v1">
                  </div>
                  <hr>
                  <div class="form-row">
                    <div class="form-group col-md-6">
                      <label for="scenario1_roofingtype">Roofing</label>
                      <select class="form-control" id="scenario1_roofingtype">
                        <option value="Asphalt" selected>Asphalt</option>
                        <option value="Tile">Tile</option>
                      </select>
                    </div>
                    <div class="form-group col-md-6">
                      <label for="scenario1_roofingpitch">Roof Pitch</label>
                      <select class="form-control" id="scenario1_roofingpitch">
                        <option value="0">Flat</option>
                        <option value="2">2/12</option>
                        <option value="3">3/12</option>
                        <option value="4">4/12</option>
                        <option value="5" selected>5/12</option>
                        <option value="6">6/12</option>
                        <option value="7">7/12</option>
                        <option value="8">8/12</option>
                        <option value="9">9/12</option>
                      </select>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="scenario1_attic">Attic Options</label>
                    <select class="form-control" id="scenario1_attic">
                      <option value="Standard Vented" selected>Standard Vented</option>
                      <option value="HPA-A">HPA - Above Deck</option>
                      <option value="HPA-B">HPA - Below Deck</option>
                      <option value="UVA">Unvented Attic</option>
                    </select>
                  </div>
                  <hr>
                  <div class="form-row">
                    <div class="form-group col-md-4">
                      <label for="scenario1_foam">Foam</label>
                      <select class="form-control" id="scenario1_foam">
                        <option value="none" selected>None</option>
                        <option value="R4">R 4</option>
                        <option value="R5">R 5</option>
                        <option value="R6">R 6</option>
                        <option value="R8">R 8</option>
                        <option value="R10">R 10</option>
                      </select>
                    </div>
                    <div class="form-group col-md-4">
                      <label for="scenario1_2x4">2x4 Cavities</label>
                      <select class="form-control" id="scenario1_2x4">
                        <option value="R 13" selected>R 13</option>
                        <option value="R 15">R 15</option>
                      </select>
                    </div>
                    <div class="form-group col-md-4">
                      <label for="scenario1_2x6">2x6 Cavities</label>
                      <select class="form-control" id="scenario1_2x6">
                        <option value="R 19" selected>R 19</option>
                        <option value="R 21">R 21</option>
                        <option value="R 23">R 23</option>
                      </select>
                    </div>
                  </div>
                  <hr>
                  <div class="form-row">
                    <div class="form-group col-md-6">
                      <label for="scenario1_hvactype">HVAC Type</label>
                      <select class="form-control" id="scenario1_hvactype">
                        <option value="Furnace" selected>Gas Furnace</option>
                        <option value="Heat Pump">Heat Pump</option>
                      </select>
                    </div>
                    <div class="form-group col-md-6">
                      <label for="scenario1_ducts">Ducts</label>
                      <select class="form-control" id="scenario1_ducts">
                        <option value="6.0" selected>R 6</option>
                        <option value="8.0">R 8</option>
                        <option value="10.0">R 10</option>
                      </select>
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-group col-md-4">
                      <label for="scenario1_heatingeff">Heating Eff</label>
                      <input type="text" class="form-control" id="scenario1_heatingeff" value="80">
                    </div>
                    <div class="form-group col-md-4">
                      <label for="scenario1_seer">SEER</label>
                      <input type="text" class="form-control" id="scenario1_seer" value="14">
                    </div>
                    <div class="form-group col-md-4">
                      <label for="scenario1_eer">EER</label>
                      <input type="text" class="form-control" id="scenario1_eer" value="12.2">
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-check form-check-inline">
                      <label class="form-check-label">
                        <input class="form-check-input" type="checkbox" id="scenario1_ecm" > ECM
                      </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <label class="form-check-label">
                        <input class="form-check-input" type="checkbox" id="scenario1_llah" > LLAH
                      </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <label class="form-check-label">
                        <input class="form-check-input" type="checkbox" id="scenario1_zoned" > Zoned
                      </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <label class="form-check-label">
                        <input class="form-check-input" type="checkbox" id="scenario1_whf" > WHF
                      </label>
                    </div>
                  </div>
                  <hr>
                  <div class="form-row">
                    <div class="form-group col-md-4">
                      <label for="scenario1_dwh">DWH Type</label>
                      <select class="form-control" id="scenario1_dwh">
                        <option value="Tankless" selected>Tankless</option>
                        <option value="Heat Pump">Heat Pump</option>
                        <option value="Gas Storage">Gas Storage</option>
                      </select>
                    </div>
                    <div class="form-group col-md-4">
                      <label for="scenario1_ef">EF Rating</label>
                      <input type="text" class="form-control" id="scenario1_ef" value=".82">
                    </div>
                    <div class="form-group col-md-4">
                      <label for="scenario1_btuh">btuh</label>
                      <input type="text" class="form-control" id="scenario1_btuh" value="19900">
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group col-md-4">
              <div class="card">
                <div class="card-header">
                  <div class="form-check form-check-inline">
                    <label class="form-check-label">
                      <input class="form-check-input" type="checkbox" id="scenario2"> Scenario 2
                    </label>
                  </div>
                </div>
                <div class="card-body">
                  <div class="form-group">
                    <label for="scenario2_label">Scenario 2 Label</label>
                    <input type="text" class="form-control" id="scenario2_label" value="v2">
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group col-md-4">
              <div class="card">
                <div class="card-header">
                  <div class="form-check form-check-inline">
                    <label class="form-check-label">
                      <input class="form-check-input" type="checkbox" id="scenario1"> Scenario 3
                    </label>
                  </div>
                </div>
                <div class="card-body">
                  <div class="form-group">
                    <label for="scenario3_label">Scenario 3 Label</label>
                    <input type="text" class="form-control" id="scenario3_label" value="v3">
                  </div>
                </div>
              </div>
            </div>
        </div>
        
        <button class="btn btn-primary" onclick="run_scenarios()">Create File</button>
      </form>
    </div>

    <script>
      function run_scenarios(){
        var info = get_project_info();
        // alert (info);
        if (document.getElementById("scenario1").checked) {
            var options = get_scenario_info("scenario1");
            sketchup.poke(info, options);
        } else{
          alert("No Scenario");
        }
      }

      function get_project_info() {
        var radios = document.getElementsByName('ruleset');
 
        for (var i = 0, length = radios.length; i < length; i++) {
            if (radios[i].checked) {
                // do whatever you want with the checked radio
                var ruleset = radios[i].value;
                // only one radio can be logically checked, don't check the rest
                break;
            }
        }
        var project_info = [ruleset, document.getElementById("planname").value, document.getElementById("address").value, document.getElementById("citystate").value, document.getElementById("zipcode").value, document.getElementById("climatezone").value, document.getElementById("totalsf").value, document.getElementById("bedroomcount").value, document.getElementById("storycount").value, document.getElementById("ceilingheight").value];
        return project_info;

      }

      function get_scenario_info(scenario){
        var scenario_options = {};
        scenario_options['RunTitle'] = document.getElementById("planname").value + " - " + document.getElementById(scenario + "_label").value;
          
          switch (document.getElementById(scenario + "_roofingtype").value) {
            case "Asphalt":
              scenario_options['RoofingLayer'] = "Light Roof (Asphalt Shingle)";
              scenario_options['RoofingType'] = "all others";
              break;
            case "Tile":
              scenario_options['RoofingLayer'] = "10 PSF (RoofTile)";
              scenario_options['RoofingType'] = "Steep Slope Roof tile, metal tile, or wood shakes";
              break;
          }

          scenario_options['RoofRise'] = document.getElementById(scenario + "_roofingpitch").value;

          switch (document.getElementById(scenario + "_attic").value) {
            case "Standard Vented":
              scenario_options['AtticType'] = "Ventilated";
              scenario_options['CeilingCavityLayer'] = "R 38";
              scenario_options['RadiantBarrier'] = 1;
              scenario_options['RoofDeckCavityLayer'] = "- no insulation -";
              scenario_options['AbvDeckInsulLayer'] = "- no insulation -";
              break;
            case "HPA-A":
              scenario_options['AtticType'] = "Ventilated";
              scenario_options['CeilingCavityLayer'] = "R 38";
              scenario_options['RadiantBarrier'] = 1;
              scenario_options['RoofDeckCavityLayer'] = "- no insulation -";
              scenario_options['AbvDeckInsulLayer'] = "R6 Sheathing";
              break;
            case "HPA-B":
              scenario_options['AtticType'] = "Ventilated";
              scenario_options['CeilingCavityLayer'] = "R 38";
              scenario_options['RadiantBarrier'] = 0;
              scenario_options['RoofDeckCavityLayer'] = "R 13";
              scenario_options['AbvDeckInsulLayer'] = "- no insulation -";
              break;
            case "UVA":
              scenario_options['AtticType'] = "Unventilated";
              scenario_options['CeilingCavityLayer'] = "- no insulation -";
              scenario_options['RadiantBarrier'] = 0;
              scenario_options['RoofDeckCavityLayer'] = "R 30";
              scenario_options['AbvDeckInsulLayer'] = "- no insulation -";
              break;
          }
          
          switch (document.getElementById(scenario + "_foam").value) {
            case "none":
              scenario_options['WallExtFinishLayer'] = "3 Coat Stucco";
              scenario_options['SheathInsulLayer'] = "- no sheathing/insul. -";
              break;
            default:
              scenario_options['WallExtFinishLayer'] = "Synthetic Stucco";
              scenario_options['SheathInsulLayer'] = document.getElementById(scenario + "_foam").value + ' Sheathing';
              break;
          }

          scenario_options['CavityLayer2x4'] = document.getElementById(scenario + "_2x4").value;
          scenario_options['CavityLayer2x6'] = document.getElementById(scenario + "_2x6").value;

          switch (document.getElementById(scenario + "_hvactype").value) {
            case "Furnace":
              scenario_options['HVACSys_type'] = "Other Heating and Cooling System";
              scenario_options['HVACSys_NumHeatSystemTypes'] = 1;
              scenario_options['HVACSys_NumCoolSystemTypes'] = 1;
              scenario_options['HVACSys_NumHtPumpSystemTypes'] = 0;
              scenario_options['HVACSys_AutoSizeHeatInp'] = 1;
              scenario_options['HVACSys_HtPumpDucted'] = 0;
              scenario_options['HVACSys_HeatSystem'] = 'HeatSystem[1] = "Heating System 1"';
              scenario_options['HVACSys_CoolSystem'] = 'CoolSystem[1] = "Cooling System 1"';
              scenario_options['HVACSys_HtPumpSystem'] = '';
              break;
            case "Heat Pump":
              scenario_options['HVACSys_type'] = "Heat Pump Heating and Cooling System";
              scenario_options['HVACSys_NumHeatSystemTypes'] = 0;
              scenario_options['HVACSys_NumCoolSystemTypes'] = 0;
              scenario_options['HVACSys_NumHtPumpSystemTypes'] = 1;
              scenario_options['HVACSys_AutoSizeHeatInp'] = 0;
              scenario_options['HVACSys_HtPumpDucted'] = 1;
              scenario_options['HVACSys_HeatSystem'] = '';
              scenario_options['HVACSys_CoolSystem'] = '';
              scenario_options['HVACSys_HtPumpSystem'] = 'HtPumpSystem[1] = "Heat Pump System 1"';
              break;
          }
          scenario_options['HVACHeat_EFF'] = document.getElementById(scenario + "_heatingeff").value;
          scenario_options['HVACCool_SEER'] = document.getElementById(scenario + "_seer").value;
          scenario_options['HVACCool_EER'] = document.getElementById(scenario + "_eer").value;
          scenario_options['HVACHtPump_Cap47'] = 24000;
          scenario_options['HVACHtPump_Cap17'] = 17000;
          if (document.getElementById(scenario + "_zoned").checked) {
            scenario_options['HVACCool_CFMperTon'] = 275;
            scenario_options['HVAC_IsZonal'] = 1;
          } else{
            scenario_options['HVACCool_CFMperTon'] = 350;
            scenario_options['HVAC_IsZonal'] = 0;
          }
          scenario_options['HVACCool_ACCharge'] = "Not Verified"
          scenario_options['HVACDist_DuctInsRvalOpt'] = document.getElementById(scenario + "_ducts").value;

          if (document.getElementById(scenario + "_llah").checked) {
            scenario_options['HVACDist_LowLkgAH'] = 1;
          } else {
            scenario_options['HVACDist_LowLkgAH'] = 0;
          }

          if (document.getElementById(scenario + "_ecm").checked) {
            scenario_options['HVACFan_WperCFMCool'] = 0.45;
          } else {
            scenario_options['HVACFan_WperCFMCool'] = 0.58;
          }
          
          if (document.getElementById(scenario + "_whf").checked) {
            scenario_options['UnitClVentOption'] = "Default Prescriptive Whole House Fan"
          } else {
            scenario_options['UnitClVentOption'] = "- none -"
          }
          
          switch (document.getElementById(scenario + "_dwh").value) {
            case "Tankless":
              scenario_options['DHWHeater_HeaterElementType'] = "Gas";
              scenario_options['DHWHeater_TankType'] = "Small Instantaneous";
              scenario_options['DHWHeater_TankVolume'] = 0;
              scenario_options['DHWHeater_EnergyFactor'] = document.getElementById(scenario + "_ef").value;
              scenario_options['DHWHeater_InputRating'] = document.getElementById(scenario + "_btuh").value;
              break;
            case "Storage":
              scenario_options['DHWHeater_HeaterElementType'] = "Gas";
              scenario_options['DHWHeater_TankType'] = "Small Storage";
              scenario_options['DHWHeater_TankVolume'] = 50;
              scenario_options['DHWHeater_EnergyFactor'] = document.getElementById(scenario + "_ef").value;
              scenario_options['DHWHeater_InputRating'] = document.getElementById(scenario + "_btuh").value;
              break;
            case "Heat Pump":
              scenario_options['DHWHeater_HeaterElementType'] = "Heat Pump";
              scenario_options['DHWHeater_TankType'] = "Small Storage";
              scenario_options['DHWHeater_TankVolume'] = 50;
              scenario_options['DHWHeater_EnergyFactor'] = document.getElementById(scenario + "_ef").value;
              scenario_options['DHWHeater_InputRating'] = 5000;
              break;
          }
                
        return scenario_options;

      }
    </script>
  </body>
